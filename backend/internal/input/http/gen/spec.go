// Package gen provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package gen

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
