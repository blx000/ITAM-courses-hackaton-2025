// Package gen provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package gen

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
